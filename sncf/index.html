<h1><a href="https://boardgamegeek.com/boardgame/75358/paris-connection">SNCF ðŸš‚</a></h1>
<p><strong>S</strong>ix <strong>N</strong>umbers, <strong>C</strong>onveniently <strong>F</strong>ormatted</p>

<ul id="pickedTrains" class="results">
</ul>

<strong>Only put these trains in the bag.</strong> Players draw from the bag as usual.<br />
When you're finished, the bag is empty.

<p>
  Players:
</p>
<ul>
  <li><label><input type="radio" name="players" value="30" checked /> 3, 5, 6</label></li>
  <li><label><input type="radio" name="players" value="32" /> 4</label></li>
</ul>

<p>
  <button id="newgame">New Game</button>
</p>

<style>
	ul {
	  list-style-type: none;
	}
	
	a:link, a:visited {
	  color: black;
	  text-decoration: none;
	}
	
	.train-number {
	  font-size: 200%;
	}
	
	.results {
	  list-style: none;
	  margin: 5px; 
	  
	  display: -webkit-box;
	  display: -moz-box;
	  display: -ms-flexbox;
	  display: -webkit-flex;
	  display: flex;
	  margin: auto;
	  
	  -webkit-flex-flow: row wrap;
	  justify-content: left;
	}

	li.number-circle {
		border-radius: 30%;
	 
		width: 36px;
		height: 36px;
		padding: 8px;
		margin: 8px;
		
		text-align: center;
		font: 32px Arial, sans-serif;
		display: inline;
	}

	li.black {
		background: #283747;
		border: 2px solid #212F3C;
		color: #ABB2B9;
	}

	li.blue {
		background: #3498DB;
		border: 2px solid #212F3C;
		color: #D5D8DC;
	}

	li.brown {
		background: #6E2C00;
		border: 2px solid #212F3C;
		color: #ABB2B9;
	}

	li.purple {
		background: #8E44AD;
		border: 2px solid #212F3C;
		color: #D5D8DC;
	}

	li.red {
		background: #E74C3C;
		border: 2px solid #212F3C;
		color: #D5D8DC;
	}

	li.yellow {
		background: #F1C40F;
		border: 2px solid #212F3C;
		color: #7D6608;
	}
</style>
	
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore.js"></script>

<script>
var data = [];
var picked = [];
var colors = ["black","blue","brown","purple","red","yellow"];

var initializeBag = function() {
	var trainsPerColor = 31;
	var trainBag = [];
  for (var i = 0; i < trainsPerColor; i++) {
	  trainBag = trainBag.concat(colors);
	}
  return trainBag;
}

var makeTrainHtml = function(grouped) {
	var html = [];
	for (var i=0; i < colors.length; ++i){
		var count = grouped[colors[i]];
		if (!count) { count = 0; }
		html = html.concat("<li class='number-circle " + colors[i] + "'>" + count + "</li>");
	}
	return html;
}

$("#newgame").click(function() {
  bag = initializeBag();
  picked = [];
  var totalPlayerTrains = $('input[name=players]:checked').val();
  
  picked = _.first(_.shuffle(bag), totalPlayerTrains);
  grouped = _.countBy(picked, function(color) {
  	return color;
  });
  
  $("#pickedTrains").html(makeTrainHtml(grouped));
});

$("input[name=players]").change(function() {
	$("#newgame").trigger("click");
});

// display trains on page load
$("#newgame").trigger("click");
</script>